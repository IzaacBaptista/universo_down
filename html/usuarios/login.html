<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Universo Down</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css"
    />
    <!-- CLOSE -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/public/css/bootstrap.min.css" />

    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/navbar.css" />
    <link rel="stylesheet" href="/public/css/style.css" />
  </head>
  <body>
    <div class="wrapper">
      <!-- Conteúdo da Página  -->
      <div class="container">
        <div class="row" id="login-card">
          <div class="card">
            <div class="card-body">
              <div class="col offset-4 mb-5">
                <img src="/public/img/logo_open.png" />
              </div>
              <div class="form-group">
                <div class="input-group">
                  <span class="input-group-addon">
                    <i class="fa fa-user fa-2x"></i>
                  </span>
                  <input
                    type="text"
                    class="form-control"
                    name="usuario"
                    id="user"
                    placeholder="Email"
                  />
                </div>
                <div class="input-group mt-3">
                  <span class="input-group-addon">
                    <i class="fa fa-lock fa-2x"></i>
                  </span>
                  <input
                    type="password"
                    class="form-control"
                    name="usuario"
                    id="pass"
                    placeholder="Senha"
                  />
                </div>
              </div>
              <div class="row">
                <a
                  href="recoverPassword.html"
                  class="col"
                  style="color: #615d5d; font-size: 14px"
                  >Esqueceu a senha?</a
                >
              </div>
              <div class="mt-3">
                <button type="button" class="btn btn-success col-12">
                  Login
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JS -->
    <script>
          //Monitorar a função de clique no botão de login no arquivo login.html
      $("#botao-login").click(function(e){
            e.preventDefault();
            //Recupera os dados digitados pelo usuário
            var username = $("#login").val();
            var password = $("#senha").val();
            //Converte no JSON esperado pela API (nesse caso, do SUAP, a API pede username e password)
            var dadosjson = JSON.stringify({"username": username, "password":password});
            //Efetiva a requisição AJAX
            $.ajax({
            url: "http://localhost:3333/login", /*Endereço do serviço de autenticação*/
            dataType: 'json', /*Tipo dos dados enviados na requisição*/
            data: dadosjson, /*Dados enviados na solicitação*/
            type: 'POST', /*Método da requisição*/
            contentType: 'application/json', /*Tipo de dado da resposta*/
            success: function (data) {/*Função que será executada caso a API tenha retornado uma resposta da classe 200*/
            alert(data.token); {/*Como esperamos um dado do tipo JSON, informado no campo contentType,acessamos um desses campos*/
            },
            error: function(data){/*Função que será executada caso a resposta não seja da classe 200*/
            alert("Impossível recuperar dados");
            }
            });
      });
    </script>
  </body>
</html>
